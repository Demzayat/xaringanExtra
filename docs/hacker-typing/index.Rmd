---
title: "xaringan<br/>poster text"
subtitle: "&#x2328;&#xFE0F;"
author: "<a href='https://www.garrickadenbuie.com/'>Garrick Aden-Buie<a>"
date: 'xaringanExtra'
output:
  xaringan::moon_reader:
    css: [robot-fonts, robot]
    chakra: remark-latest.min.js
    seal: false
    lib_dir: libs
    hightlight: true
---

class: title center middle

```{r slide-tone, echo=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r hacker-type, echo=FALSE}
xaringanExtra::use_hacker_type()
```

```{r eval=FALSE, include=FALSE}
htmltools::tagList(
	# xaringanExtra:::html_dependency_hacker_typing()
	htmltools::htmlDependency(
    name = "typer-js",
    version = "1.0.2",
    # package = "xaringanExtra",
    src = "../../inst/libs/typer-js",
    script = "typer.min.js",
    stylesheet = "typer.css",
    all_files = FALSE
  ),
  htmltools::htmlDependency(
    name = "hacker-type",
    version = packageVersion("xaringanExtra"),
    # package = "xaringanExtra",
    src = "../../inst/hacker-type",
    script = "hacker-type.js",
    all_files = FALSE
  )
)
```

```{css echo=FALSE}
.code {
	font-family: Inconsolata, Consolas, Monaco, monospace;
}
```

# xaringan<br>.hacker-type[hacker type]

## &#x2328;&#xFE0F;

[Garrick Aden-Buie](https://www.garrickadenbuie.com)

.hacker-type.hacker-type-military.hacker-type-hide-cursor.code[
xaringanExtra
]

---

## Quick Start

.hacker-type[
In your slides, type:

````
```{r xaringanExtra}`r ''`
xaringanExtra::use_hacker_type()
```
````

### Then type live without breaking a sweat

Use the `.hacker-type` class to add live typing to parts of your slides.

<pre><code>---<br>
<br>
# Type live...<br>
<br>
.hacker-type&zwj;[<br>
The quick dog jumped over the lazy fox<br>
]</code></pre>
]

---

class: inverse hacker-type
background-image: url('hacker-laptop.jpg')
background-size: cover

<!-- background image source: https://unsplash.com/photos/FXFz-sW0uwo -->

# Write the whole slide live

Use the slide class `hacker-type` to write  
your slide content "live" for your audience.

```
---
class: hacker-type

# Write the whole slide live...
```


---

# Controlled live typing

Add the class `.hacker-type-on-click`
to `.hacker-type`
to be able to start, pause and restart the typing
with a click.

The code block below is wrapped in `.hacker-type.hacker-type-on-click[...]`

Click the block below to start coding!

.hacker-type.hacker-type-on-click[
```{r, eval=FALSE}
babynames <-
  babynames::babynames %>%
  filter(
  	name %in% c("May", "June", "August"),
  	year >= 2000
  ) %>%
  group_by(year, name) %>%
  summarize(n = sum(n)) %>%
  ungroup()
```
]

---
layout: true
# Other Options

---

## Military typing

Add the `.hacker-type-miliary` class to use military scrambled typing.

```md
.hacker-type.hacker-type-military[military]
```

.hacker-type.hacker-type-military[password]

---

## Show or Hide the cursor

The cursor is automatically shown or hidden 
depending on what tends to look the best.
But you can force the cursor to be shown or hidden:

Add the `.hacker-type-hide-cursor` class to **hide** the cursor.

.hacker-type.hacker-type-hide-cursor[
```md
.hacker-type.hacker-type-hide-cursor[hide the cursor.]
```
]

Add the `.hacker-type-show-cursor` class to **show** the cursor.

.hacker-type.hacker-type-show-cursor[
```md
---
class: hacker-type hacker-type-show-cursor

Show the cursor when typing this slide...
```
]




---
layout: false

# Speed

## Fast

.hacker-type.hacker-type-fast[Add `.hacker-type-fast[]` for fast typing]

## Normal

.hacker-type.hacker-type-normal[Add `.hacker-type-normal[]` for normal typing (or don't add anything)]

## Slow

.hacker-type.hacker-type-slow[Add `.hacker-type-slow[]`  for slower typing]

---
layout: false

# Notes

## .hacker-type[typer.js]

This extension uses [typer.js](https://github.com/qodesmith/typer),
a nice, low-dependency JavaScript library for automatic typing.

## Details

typer.js does the typing into a `<div>` tag, 
which means that anything that is live typed
is typed on a new line.

Or in other words, 
you can't live type just a few words in a sentence.

---
layout: false
class: center middle

<img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" width="25%" />

### <span class="hacker-type" style="color:#0051BA;">[gadenbuie/xaringanExtra](https://github.com/gadenbuie/xaringanExtra)</span>

```{js, eval=FALSE, echo=FALSE}
class HackerTyper {
  constructor() {
    this.typers = this.findHackerTypers(document.querySelector('.remark-slides-area'))
		this.typers.forEach(el => this.prepareHacker(el))
		this.hasSlideListener = false
		this.runCurrentSlideTypers()
  }
  
  randId() {
		return Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
	}
	
	findHackerTypers(scope = document) {
	  const containers = scope.querySelectorAll('.hacker-type')
	  if (!containers) return null;
	  return containers.map(container => {
	    let id = this.randId()
	    let text,selector = null
	    container.id = id
	    let cursor = container.tagName === 'SPAN' &&
	      !container.matches('.hacker-type-no-cursor')
	    let military = container.matches('.hacker-type-military')
	    if (
	      container.firstChild.tagName === "PRE" &&
	      container.firstChild.firstChild.tagName === "CODE"
	    ) {
	      let codeNode = container.querySelector('code')
	      text = codeNode.innerHTML
	        .toString()
	        .replace(/<div/g, '<span')
	        .replace(/<\/div>/g, '</span><br>')
	      container.querySelector('code').innerHTML = ' '
	      selector = 'pre > code'
	      cursor = true
	    } else if (container.matches('.remark-slide-content')) {
	      // if the slide is .hacker-type then move the 
	      // .hacker-type div inside the slide
	      let newDiv = document.createElement('div')
	      newDiv.classList.add('hacker-type')
	      newDiv.classList.add('hacker-type-on-show')
	      newDiv.id = container.id
	      let slideNumber = container.querySelector('.remark-slide-number')
	      newDiv.appendChild(slideNumber)
	      text = container.innerHTML
	      container.id = null
	      container.innerHTML = ''
	      container.appendChild(newDiv)
	      container.appendChild(slideNumber)
	      container.classList.remove('hacker-type')
	      container = newDiv
	    } else {
	      text = container.innerHTML
	      container.innerHTML = ' '
	    }
	    return {
	      container, 
	      id, 
	      text: text.trim() + ' ', 
	      event: this.hackerEvent(container), 
	      selector,
	      cursor,
	      military
	    }
	  })
	}
	
	hackerEvent(el) {
	  if (el.matches('[class^="remark-slide"]')) {
	    return 'slide'
	  }
	  if (el.classList.contains('hacker-type-on-click')) {
	    return 'click'
	  }
	  if (el.classList.contains('hacker-type-on-show')) {
	    return 'slide'
	  }
	  return 'slide'
	}
	
	prepareHacker({container, id, text, event = 'slide', ...ht}) {
	  if (event === 'click') {
	    container.addEventListener('click', (event) => {
	      if (event.altKey) {
	        this.finishTyper(event)
	      } else {
	    		this.handleHackerClick(event)
	      }
	    })
	  } else if (event === 'slide' && !this.hasSlideListener) {
	    this.hasSlideListener = true
      slideshow.on('afterShowSlide', () => {
        this.runCurrentSlideTypers()
      })
	  }
	  container.addEventListener('typer-done', this.finishTyper)
	}
	
	runCurrentSlideTypers = () => {
	  let hts = document.querySelectorAll('.remark-visible .remark-slide-content .hacker-type:not(.hacker-type-on-click)')
    if (!(hts || hts.length)) return
    hts.forEach(target => this.handleHackerClick()({target}))
	}
	
	handleHackerClick() {
	 return function(event) {
		  let elClicked = event.target.closest('.hacker-type')
		  const htIdx = this.typers.findIndex(o => o.id === elClicked.id)
		  let ht = this.typers[htIdx]
		  let container = ht.container
		  if (ht.selector) {
		    container = ht.container.querySelector(ht.selector)
		  }
		  if (
		    typeof elClicked.dataset.hackerState === 'undefined' ||
		    elClicked.dataset.hackerState === 'done'
		  ) {
		    elClicked.dataset.hackerState = 'typing'
		    if (ht.typer) {
		      ht.typer.kill()
		      ht.typer = null
		    }
		    ht.typer = typer(container)
		      .empty()
		      .cursor(ht.cursor)
		      .line(ht.text, {html: true, min: 15, max: 125, military: ht.military ? 50 : false})
		      .emit('typer-done', container)
		  } else if (elClicked.dataset.hackerState === 'typing') {
		    ht.typer.halt()
		    elClicked.dataset.hackerState = 'halted'
		  } else if (elClicked.dataset.hackerState === 'halted') {
		    ht.typer.resume()
		    elClicked.dataset.hackerState = 'typing'
		  }
		}
	}
	
	finishTyper() return function(event) => {
	  let elDone = event.target.closest('.hacker-type')
	  const htIdx = this.typers.findIndex(o => o.id === elDone.id)
	  let ht = this.typers[htIdx]
	  if (ht.typer === null) return
	  let container = ht.container
	  // console.log(ht.id + ' stopped')
	  // ht.typer.kill()
	  // ht.typer = null
	  elDone.dataset.hackerState = 'done'
	}
 
}

let ht = new HackerTyper()

// let container = document.querySelector('.remark-visible .hacker-type')
// let pre = container.cloneNode(true)
// pre.querySelector('code').innerHTML = ''
// container.style.display = 'none'

// container.parentNode.insertBefore(pre, container.nextSibling)

// typer(pre.querySelector('code')).cursor(false).line(container.querySelector('code').innerHTML, {html: true, min: 15, max: 150, military: 50})
```
